<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Phillip Geo / BareetDesign</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="geoportofolio.png" type="image/png">
</head>
<body>
<header>
  <div class="logo">
    <a href="index.html" id="site-title" style="text-decoration:none;color:inherit;">
      Phillip Geo / BareetDesign
    </a>
  </div>
  <nav>
    <a href="index.html" class="active">Projekter</a>
    <a href="about.html">Om</a>
    <a href="contact.html">Kontakt</a>
    <a href="admin.html" class="admin-link">ðŸ”’</a>
  </nav>
</header>

<main>
  <!-- Intro / tekst over projekter -->
  <section id="intro-text" class="intro-box">
    <h2>Loading...</h2>
    <p>Loading...</p>
  </section>

  <!-- Projekter -->
  <section id="projects-grid" class="grid">
    <p>Loading projects...</p>
  </section>
</main>

<footer>
  <div class="footer-social">
    <!-- Mail -->
    <a id="footer-mail" href="mailto:phillipgeo7@gmail.com">
      <img src="icons/mail.png" class="social-icon" alt="Mail">
      <span>phillipgeo7@gmail.com</span>
    </a>

    <!-- Telefon -->
    <a id="footer-phone" href="tel:+4593956339">
      <img src="icons/phone.png" class="social-icon" alt="Phone">
      <span>+45 93 95 63 39</span>
    </a>

    <!-- LinkedIn -->
    <a id="footer-linkedin" href="#" target="_blank">
      <img src="icons/linkedin.png" class="social-icon" alt="LinkedIn">
      <span>LinkedIn</span>
    </a>

    <!-- Instagram -->
    <a id="footer-instagram" href="#" target="_blank">
      <img src="icons/instagram.png" class="social-icon" alt="Instagram">
      <span>Instagram</span>
    </a>
  </div>
</footer>

<!-- Copyright -->
<div id="copyright">
  <p>&copy; <span id="copyright-text"></span></p>
</div>

<script type="module">
import { createClient } from 'https://esm.sh/@supabase/supabase-js'

const SUPABASE_URL = "https://tuogdyemsfdmhxrvmrlq.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR1b2dkeWVtc2ZkbWh4cnZtcmxxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgwMjQ5OTAsImV4cCI6MjA3MzYwMDk5MH0.yHeM8tkZuzA8PuooVIOrDtdgCTS3jfuXLzQ55-235NU";
const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

// Hent footer, site title og intro-tekst
async function loadSiteData() {
  try {
    const { data: siteData, error } = await supabase
      .from('site_content')
      .select('*')
      .eq('id', 1)
      .single();

    if (error) throw error;

    if (siteData) {
      // Titel
      document.getElementById('site-title').textContent = siteData.siteTitle;

      // Intro tekst over projekter
      const introSection = document.getElementById('intro-text');
      if (introSection) {
        introSection.innerHTML = `
          <h2>${siteData.introTitle}</h2>
          <p>${siteData.introText}</p>
        `;
      }

      // Mail
      document.getElementById('footer-mail').href = siteData.contactMail ? `mailto:${siteData.contactMail}` : '#';
      document.querySelector('#footer-mail span').textContent = siteData.contactMail || 'Mail';
      document.querySelector('#footer-mail img').src = siteData.footerMailIcon || 'icons/mail.png';

      // Telefon
      document.getElementById('footer-phone').href = siteData.contactPhone ? `tel:${siteData.contactPhone}` : '#';
      document.querySelector('#footer-phone span').textContent = siteData.contactPhone || 'Telefon';
      document.querySelector('#footer-phone img').src = siteData.footerPhoneIcon || 'icons/phone.png';

      // LinkedIn
      document.getElementById('footer-linkedin').href = siteData.contactLinkedin || '#';
      document.querySelector('#footer-linkedin img').src = siteData.footerLinkedinIcon || 'icons/linkedin.png';

      // Instagram
      document.getElementById('footer-instagram').href = siteData.contactInstagram || '#';
      document.querySelector('#footer-instagram img').src = siteData.footerInstagramIcon || 'icons/instagram.png';

      // Copyright
      document.getElementById('copyright-text').textContent = siteData.copyright || "Phillip Geo / BareetDesign";
    }
  } catch (e) {
    console.error('Error loading site content:', e);
  }
}

// Projekter
async function loadProjects() {
  try {
    const { data: projects, error } = await supabase
      .from('projects')
      .select('*')
      .order('created_at', { ascending: false });

    const grid = document.getElementById('projects-grid');
    grid.innerHTML = '';

    if (error) throw error;

    if (projects && projects.length > 0) {
      projects.forEach(p => {
        const a = document.createElement('a');
        a.href = p.link || '#';
        a.className = 'project';

        const img = document.createElement('img');
        img.src = p.image_url || 'images/placeholder.png';
        img.alt = p.title;

        const content = document.createElement('div');
        content.className = 'project-content';

        const h3 = document.createElement('h3');
        h3.textContent = p.title;

        const url = document.createElement('div');
        url.className = 'project-url';
        url.textContent = p.link || 'No link';

        content.appendChild(h3);
        content.appendChild(url);
        a.appendChild(img);
        a.appendChild(content);

        grid.appendChild(a);
      });
    } else {
      grid.innerHTML = '<p>Ingen projekter fundet.</p>';
    }
  } catch (e) {
    console.error('Error loading projects:', e);
  }
}

loadSiteData();
loadProjects();
</script>
</body>
</html>
