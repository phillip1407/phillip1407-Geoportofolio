<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Phillip Geo / BareetDesign</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="geoportofolio.png" type="image/png">
</head>
<body>
<header>
  <div class="logo">
    <a href="index.html" id="site-title" style="text-decoration:none;color:inherit;">
      Phillip Geo / BareetDesign
    </a>
  </div>
  <nav>
    <a href="index.html" class="active">Projects</a>
    <a href="about.html">About</a>
    <a href="contact.html">Contact</a>
    <a href="admin.html" class="admin-link">Admin</a>
  </nav>
</header>

<main>
  <section class="grid" style="padding:24px;">
    <div id="projects-list">
      <p>Loading projects...</p>
    </div>
  </section>
</main>

<footer id="site-footer">
  <div id="footer-left"></div>
  <div id="footer-middle">
    <a id="footer-mail" href="mailto:phillipgeo7@gmail.com">phillipgeo7@gmail.com</a><br>
    <a id="footer-phone" href="tel:+4593956339">+45 93 95 63 39</a>
  </div>
  <div id="footer-right">
    <div id="social-icons"></div>
  </div>
</footer>

<div id="copyright">
  <p>&copy; <span id="copyright-text"></span></p>
</div>

<script type="module">
import { createClient } from 'https://esm.sh/@supabase/supabase-js'

const SUPABASE_URL = "https://tuogdyemsfdmhxrvmrlq.supabase.co"
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
const supabase = createClient(SUPABASE_URL, SUPABASE_KEY)

async function loadSiteData(){
  try {
    const { data: siteData, error } = await supabase
      .from('site_content')
      .select('*')
      .eq('id', 1)
      .single()

    if(error) throw error

    if(siteData){
      // Titel + venstre footer
      document.getElementById('site-title').textContent = siteData.siteTitle
      document.getElementById('footer-left').innerText = siteData.footerLeft

      // Social media ikoner (fra Supabase)
      const socialDiv = document.getElementById('social-icons')
      socialDiv.innerHTML = `
        <a href="${siteData.footerLinkedin}" target="_blank">
          <img src="${siteData.footerLinkedinLogo}" alt="LinkedIn" style="width:20px;vertical-align:middle;">
          LinkedIn
        </a><br>
        <a href="${siteData.footerInstagram}" target="_blank">
          <img src="${siteData.footerInstagramLogo}" alt="Instagram" style="width:20px;vertical-align:middle;">
          Instagram
        </a>
      `

      // Copyright tekst
      document.getElementById('copyright-text').textContent = siteData.copyright
    }
  } catch (err) {
    console.error('Error loading site data:', err.message)
  }
}

async function loadProjects(){
  try {
    const { data: projects, error } = await supabase
      .from('projects')
      .select('*')
      .order('id', { ascending: false })

    if(error) throw error

    const container = document.getElementById('projects-list')
    container.innerHTML = ""
    if(projects && projects.length > 0){
      projects.forEach(project => {
        const div = document.createElement('div')
        div.classList.add('project-item')
        div.innerHTML = `
          <h3>${project.title}</h3>
          <p>${project.description}</p>
          ${project.image_url ? `<img src="${project.image_url}" alt="${project.title}" style="max-width:200px;">` : ""}
        `
        container.appendChild(div)
      })
    } else {
      container.innerHTML = "<p>No projects available.</p>"
    }
  } catch (err) {
    console.error('Error loading projects:', err.message)
  }
}

loadSiteData()
loadProjects()
</script>
</body>
</html>
